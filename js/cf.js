var checkWin=function(matrix,row,column){var winner=!1,lu=ru=rd=ld=0,lus=!1,rus=!1,rds=!1,lds=!1;for(var c=0;c<=3;c++)console.log("*for c = "+c+" , row = "+row),matrix[row][c]==matrix[row][c+1]&&typeof matrix[row][c]!="undefined"&&(console.log("if ((matrix[row][c] == matrix[row][c + 1]) && ((typeof matrix[row][c]) != undefined)) {"),matrix[row][c]==matrix[row][c+2]&&(console.log("if (matrix[row][c] == matrix[row][c + 2]) {"),matrix[row][c]==matrix[row][c+3]&&(console.log("if (matrix[row][c] == matrix[row][c + 3]) {"),winner=!0)));if(!winner)for(var r=0;r<=2;r++)matrix[r][column]==matrix[r+1][column]&&typeof matrix[r][column]!="undefined"&&matrix[r][column]==matrix[r+2][column]&&matrix[r][column]==matrix[r+3][column]&&(winner=!0);if(!winner){for(var i=1;i<=3;i++)typeof matrix[row-i]!="undefined"&&(typeof matrix[row-i][column-i]!="undefined"&&(matrix[row][column]==matrix[row-i][column-i]&&!lus?lu++:lus=!0),typeof matrix[row-i][column+i]!="undefined"&&(matrix[row][column]==matrix[row-i][column+i]&&!rus?ru++:rus=!0)),typeof matrix[row+i]!="undefined"&&(console.log("has row below"),typeof matrix[row+i][column+i]!="undefined"&&(matrix[row][column]==matrix[row+i][column+i]&&!rds?rd++:rds=!0),typeof matrix[row+i][column-i]!="undefined"&&(console.log("has row below-left"),matrix[row][column]==matrix[row+i][column-i]&&!lds?(console.log("has row below-lefta and equals"),ld++):(lds=!0,console.log("has row below-lefta and NOT equals"))));if(lu==3||ru==3||rd==3||ld==3)winner=!0}return winner};$(document).ready(function(){var isMobile;$("#board-container").height()==280?isMobile=!0:isMobile=!1;var sndDisk=new Audio,sndCheer=new Audio,sndLoop=new Audio;sndDisk.src="audio/click.ogg",sndCheer.src="audio/cheer.ogg",sndLoop.src="audio/loop.ogg",sndLoop.addEventListener("ended",function(){this.currentTime=0,this.play()},!1),$("div#next").addClass("disc_player disc_player0");if($("#board-container").height()==280)var boardMargin=7,diskRadious=35;else var boardMargin=20,diskRadious=70;var player=0,disk=0,matrix=new Array(6);for(i=0;i<6;i++)matrix[i]=new Array(7);var dropDisc=function(column,p,row){disk++;var nextRow,topOccupiedRow=6,diskLeftMargin=boardMargin+column*(boardMargin+diskRadious);for(k=5;k>=0;k--)typeof matrix[k][column]!="undefined"&&(topOccupiedRow=k);typeof topOccupiedRow=="undefined"?nextRow=5:nextRow=topOccupiedRow-1;if($("#board-container").height()==280){isMobile=!0;var responsive_length=62,responsive_length_2=52}else{isMobile=!1;var responsive_length=110,responsive_length_2=42}if(topOccupiedRow>0){console.log("var depth = boardMargin + (nextRow - 1) * (boardMargin + diskRadious) + responsive_length"),console.log("boardMargin="+boardMargin+"nextRow - 1="+(nextRow-1)+"boardMargin="+boardMargin+"diskRadious"+diskRadious+"responsive_length="+responsive_length);if(!isMobile)var depth=boardMargin+nextRow*(25+diskRadious);else var depth=boardMargin+nextRow*(10+diskRadious);matrix[nextRow][column]=p,$("#board-container").prepend('<div class="disc_player disc_player'+p+'" id="dp'+disk+'" style="margin-left: '+(isMobile?diskLeftMargin+column*4:diskLeftMargin)+"px; z-index: "+(disk-responsive_length_2)+'"></div>'),$("#dp"+disk).animate({top:"+="+depth},200,function(){sndDisk.play()}),checkWin(matrix,nextRow,column)?setTimeout(function(){sndCheer.play();var playerLabel=player?"YELLOW":"RED  ";alert("Player "+playerLabel+" wins!!!\n Click ok to reload page and try again..."),window.location.reload()},400):disk==42?(alert("No winner here :(\n Hit ok to reload page..."),window.location.reload()):(player=player?0:1,$("div#next").removeClass("disc_player"+Math.abs(player-1)),$("div#next").addClass("disc_player"+player))}else disk--},eventCb=function(column){return navigator.mozVibrate&&navigator.mozVibrate(1e3),function(){dropDisc(column,player,2)}};for(i=0;i<=6;i++)if(isMobile){$("#controls").append('<div id="col'+i+'" class="control">&darr;</div>');var control=document.querySelector("#col"+i);(new GestureDetector(control)).startDetecting(),control.addEventListener("tap",eventCb(i))}else $("#controls").append('<button id="col'+i+'" class="control">&darr;</button>'),$("#col"+i).click(eventCb(i));for(j=0;j<=41;j++)$("#board").append('<div class="hole"></div>')})